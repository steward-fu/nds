precision highp float;

uniform float frag_alpha;
uniform float frag_screen_w;
uniform float frag_screen_h;
varying vec2 frag_tex_coord;
uniform sampler2D frag_tex_sample;

#define PI 3.141592654
#define BRIGHTEN_SCANLINES 16.0
#define BRIGHTEN_LCD 4.0

void main()
{
    float w = frag_screen_w;
    float h = frag_screen_h;

    vec2 pixelCoord = frag_tex_coord * vec2(w, h);
    vec2 angle = 2.0 * PI * (pixelCoord - 0.25);

    float yfactor = (BRIGHTEN_SCANLINES + sin(angle.y)) / (BRIGHTEN_SCANLINES + 1.0);
    float xfactor = (BRIGHTEN_LCD + sin(angle.x)) / (BRIGHTEN_LCD + 1.0);

    vec3 colour = texture2D(frag_tex_sample, frag_tex_coord).bgr;

    colour.rgb = yfactor * xfactor * colour.rgb;

    gl_FragColor = vec4(colour.rgb, frag_alpha);
}
